–í Django –ø–∞—Ä–∞–º–µ—Ç—Ä `on_delete` —É–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –≤ –ø–æ–ª—è—Ö –º–æ–¥–µ–ª–µ–π `ForeignKey` –∏ `OneToOneField`.   
–û–Ω –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, —á—Ç–æ –¥–æ–ª–∂–Ω–æ –ø—Ä–æ–∏–∑–æ–π—Ç–∏ —Å –æ–±—ä–µ–∫—Ç–æ–º –º–æ–¥–µ–ª–∏, **–µ—Å–ª–∏ —Å–≤—è–∑–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç –±—É–¥–µ—Ç —É–¥–∞–ª—ë–Ω**.   
Django **—Ç—Ä–µ–±—É–µ—Ç** —è–≤–Ω–æ —É–∫–∞–∑—ã–≤–∞—Ç—å `on_delete`, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –Ω–µ–æ—á–µ–≤–∏–¥–Ω–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.

---

## ‚úÖ –í—Å–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è `on_delete`:

| –ó–Ω–∞—á–µ–Ω–∏–µ             | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                |
| -------------------- | --------------------------------------------------------------------------------------- |
| `models.CASCADE`     | **–ö–∞—Å–∫–∞–¥–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ**: –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ —É–¥–∞–ª—è–µ—Ç—Å—è –∏ —Ç–µ–∫—É—â–∏–π –æ–±—ä–µ–∫—Ç.     |
| `models.PROTECT`     | **–ó–∞–ø—Ä–µ—â–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ** —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞, –µ—Å–ª–∏ –Ω–∞ –Ω–µ–≥–æ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏.                    |
| `models.SET_NULL`    | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `NULL` –≤ –ø–æ–ª–µ, –µ—Å–ª–∏ —É–¥–∞–ª—è–µ—Ç—Å—è —Å–≤—è–∑–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç. **–¢—Ä–µ–±—É–µ—Ç `null=True`**.  |
| `models.SET_DEFAULT` | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é (`default=...`) –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.    |
| `models.SET(...)`    | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –∏–ª–∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏—é –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.  |
| `models.DO_NOTHING`  | Django **–Ω–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç**, –Ω–æ —ç—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (–Ω–∞—Ä—É—à–µ–Ω–∏–µ FK). |
| `models.RESTRICT`    | Django –∑–∞–ø—Ä–µ—â–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞, **–µ—Å–ª–∏ –µ—Å—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏**.                      |

---

## üîç –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏ –ø–æ –∫–∞–∂–¥–æ–º—É:

### 1. `CASCADE`

> –ï—Å–ª–∏ —É–¥–∞–ª–∏—Ç—å –∞–≤—Ç–æ—Ä–∞, –≤—Å–µ –µ–≥–æ –∫–Ω–∏–≥–∏ —Ç–æ–∂–µ –±—É–¥—É—Ç —É–¥–∞–ª–µ–Ω—ã.

```python
author = models.ForeignKey(Author, on_delete=models.CASCADE)
```

### 2. `PROTECT`

> –í—ã–±—Ä–æ—Å–∏—Ç `ProtectedError`, –µ—Å–ª–∏ –ø–æ–ø—ã—Ç–∞—Ç—å—Å—è —É–¥–∞–ª–∏—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –µ—Å—Ç—å —Å—Å—ã–ª–∫–∞.

```python
author = models.ForeignKey(Author, on_delete=models.PROTECT)
```

### 3. `SET_NULL`

> –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `null` –≤–º–µ—Å—Ç–æ —É–¥–∞–ª—ë–Ω–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞.

```python
author = models.ForeignKey(Author, on_delete=models.SET_NULL, null=True)
```

### 4. `SET_DEFAULT`

> –ü–æ–¥—Å—Ç–∞–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.

```python
author = models.ForeignKey(Author, on_delete=models.SET_DEFAULT, default=1)
```

### 5. `SET(...)`

> –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é –∏–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ. –ß–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ "–∞–Ω–æ–Ω–∏–º–Ω–æ–≥–æ –∞–≤—Ç–æ—Ä–∞" –∏ —Ç.–ø.

```python
def get_default_author():
    return Author.objects.get(name='Anonymous')

author = models.ForeignKey(Author, on_delete=models.SET(get_default_author))
```

–ò–ª–∏ –∑–Ω–∞—á–µ–Ω–∏–µ –Ω–∞–ø—Ä—è–º—É—é:

```python
author = models.ForeignKey(Author, on_delete=models.SET(1))
```

### 6. `DO_NOTHING`

> –ù–∏—á–µ–≥–æ –Ω–µ –¥–µ–ª–∞–µ—Ç ‚Äî –≤—ã —Å–∞–º–∏ –¥–æ–ª–∂–Ω—ã –ø–æ–∑–∞–±–æ—Ç–∏—Ç—å—Å—è, —á—Ç–æ–±—ã —É–¥–∞–ª–µ–Ω–∏–µ –Ω–µ –≤—ã–∑–≤–∞–ª–æ –æ—à–∏–±–æ–∫. –ù–µ —Ä–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ –±–µ–∑ –æ—Å–æ–±—ã—Ö –ø—Ä–∏—á–∏–Ω.

```python
author = models.ForeignKey(Author, on_delete=models.DO_NOTHING)
```

### 7. `RESTRICT` (–Ω–∞—á–∏–Ω–∞—è —Å Django 3.1)

> –°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π —Å–ø–æ—Å–æ–± —è–≤–Ω–æ –∑–∞–ø—Ä–µ—Ç–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ, –µ—Å–ª–∏ –µ—Å—Ç—å —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã. –ü–æ–≤–µ–¥–µ–Ω–∏–µ –ø–æ—Ö–æ–∂–µ –Ω–∞ `PROTECT`, –Ω–æ –∫–æ–Ω—Ü–µ–ø—Ç—É–∞–ª—å–Ω–æ –±–ª–∏–∂–µ –∫ SQL `RESTRICT`.

```python
author = models.ForeignKey(Author, on_delete=models.RESTRICT)
```

---

## –ü–æ–ª–µ–∑–Ω—ã–µ —Å–æ–≤–µ—Ç—ã

| –°–∏—Ç—É–∞—Ü–∏—è                                       | –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è            |
| ---------------------------------------------- | ------------------------ |
| –£–¥–∞–ª–µ–Ω–∏–µ —Ä–æ–¥–∏—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ —É–¥–∞–ª—è—Ç—å –≤—Å—ë —Å–≤—è–∑–∞–Ω–Ω–æ–µ | `CASCADE`                |
| –ù–µ–ª—å–∑—è —É–¥–∞–ª—è—Ç—å, –µ—Å–ª–∏ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏               | `PROTECT` –∏–ª–∏ `RESTRICT` |
| –°—Å—ã–ª–∫—É –º–æ–∂–Ω–æ –æ–±–Ω—É–ª–∏—Ç—å                          | `SET_NULL`               |
| –ï—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é                     | `SET_DEFAULT`            |
| –•–æ—Ç–∏—Ç–µ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ          | `SET(...)`               |
| –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –≤—Ä—É—á–Ω—É—é                        | `DO_NOTHING`             |


### –ß–µ–º –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è `PROTECT` –∏ `RESTRICT`?

---

## ‚öñÔ∏è `on_delete=PROTECT` vs `on_delete=RESTRICT`

| –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∞         | `PROTECT` (Django)                                   | `RESTRICT` (SQL / Django 3.1+)                      |
| ---------------------- | ---------------------------------------------------- | --------------------------------------------------- |
| ‚õî –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?          | –ó–∞–ø—Ä–µ—â–∞–µ—Ç —É–¥–∞–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞, –µ—Å–ª–∏ –Ω–∞ –Ω–µ–≥–æ –µ—Å—Ç—å —Å—Å—ã–ª–∫–∏ | –¢–æ –∂–µ —Å–∞–º–æ–µ: –Ω–µ –¥–∞—ë—Ç —É–¥–∞–ª–∏—Ç—å, –µ—Å–ª–∏ –µ—Å—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ |
| üìç –ì–¥–µ —Ä–∞–±–æ—Ç–∞–µ—Ç?       | **–í Python —É—Ä–æ–≤–Ω–µ Django ORM**                       | **–ù–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (SQL RESTRICT)**            |
| üß† –ö—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç?      | Django (–≤ Python-–∫–æ–¥–µ)                               | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (SQL FK constraint)                     |
| üìÖ –ö–æ–≥–¥–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è?  | –î–æ —É–¥–∞–ª–µ–Ω–∏—è, –ø—Ä–∏ –≤—ã–∑–æ–≤–µ `.delete()`                  | –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ SQL-–∑–∞–ø—Ä–æ—Å–∞ `DELETE`                 |
| üõ† –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤ Django  | –ï—Å—Ç—å –¥–∞–≤–Ω–æ (–≤—Å–µ–≥–¥–∞)                                  | –¢–æ–ª—å–∫–æ —Å Django **3.1+**                            |
| üí¨ –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ | `ProtectedError` (Django –∏—Å–∫–ª—é—á–µ–Ω–∏–µ)                 | `IntegrityError` –æ—Ç –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö                     |

---

### üìå –û—Å–Ω–æ–≤–Ω—ã–µ –æ—Ç–ª–∏—á–∏—è:

| –í–æ–ø—Ä–æ—Å                        | –û—Ç–≤–µ—Ç                                           |
| ----------------------------- | ----------------------------------------------- |
| –ú–æ–∂–Ω–æ –ª–∏ –æ–±–æ–π—Ç–∏ –≤ raw SQL?    | `PROTECT` ‚Äî –¥–∞, –ª–µ–≥–∫–æ. `RESTRICT` ‚Äî –Ω–µ—Ç         |
| –ë—É–¥–µ—Ç –ª–∏ —Ä–∞–±–æ—Ç–∞—Ç—å –≤–Ω–µ Django? | `PROTECT` ‚Äî –Ω–µ—Ç. `RESTRICT` ‚Äî –¥–∞                |
| –ß—Ç–æ –±–µ–∑–æ–ø–∞—Å–Ω–µ–µ?               | `RESTRICT`, –µ—Å–ª–∏ –≤–∞–∂–Ω–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ –ë–î |


---

## üß© –í—ã–≤–æ–¥

* –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º, `PROTECT` ‚Äî —ç—Ç–æ Python-—É—Ä–æ–≤–µ–Ω—å, –∞ `RESTRICT` ‚Äî —ç—Ç–æ–π SQL-—É—Ä–æ–≤–µ–Ω—å
* –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **`RESTRICT`**, –µ—Å–ª–∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ **–∂—ë—Å—Ç–∫–æ** –∑–∞–ø—Ä–µ—Ç–∏—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö.
* –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ **`PROTECT`**, –µ—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ **–æ—Ç–ª–æ–≤–∏—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –≤ Django-–∫–æ–¥–µ** –∏ –æ—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å.

