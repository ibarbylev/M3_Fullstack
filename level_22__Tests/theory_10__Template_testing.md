# Тестирование шаблонов

## 1 Краткая теория: клиент в Django

В **pytest-django** (и в стандартных Django-тестах) **клиент** — это объект, который имитирует поведение веб-браузера.

**Что делает клиент:**

| Особенность                        | Описание                                                                        |
| ---------------------------------- | ------------------------------------------------------------------------------- |
| `client.get(url)`                  | Выполняет GET-запрос к указанному URL                                           |
| `client.post(url, data)`           | Выполняет POST-запрос с данными формы                                           |
| `client.login(username, password)` | Логиним пользователя для доступа к защищенным страницам                         |
| `response`                         | Объект, который возвращает клиент: содержит статус, шаблон, контекст и HTML-код |

**Ключевые атрибуты `response`:**

* `response.status_code` — код ответа (200, 302 и т.д.)
* `response.context` — словарь с переменными, переданными в шаблон
* `response.templates` — список шаблонов, которые использовались при рендере
* `response.content` — HTML страницы в байтах

---

## 2 Что и как тестируем в блоке шаблонов?

При тестировании шаблонов Django, наш цель — убедиться, что:

1. View рендерит правильный шаблон
2. В шаблон передан корректный контекст
3. В HTML присутствуют нужные элементы (формы, таблицы, кнопки, тексты)

**Пример логики тестирования:**

| Название теста              | Что проверяет           | Как проверяет                                                                                                      |
| --------------------------- | ----------------------- | ------------------------------------------------------------------------------------------------------------------ |
| `test_author_list_template` | Список авторов          | Проверяет код 200, шаблон `author_list.html`, контекст `authors`, HTML-список                                      |
| `test_book_list_template`   | Список книг             | Проверяет код 200, шаблон `book_list.html`, контекст `object_list`, таблицу с книгами                              |
| `test_book_create_template` | Страница создания книги | Проверяет код 200, шаблон `book_form.html`, контекст `book_form` и `detail_form`, наличие формы и кнопки «Создать» |
| `test_book_detail_template` | Страница деталей книги  | Проверяет код 200, шаблон `book_detail.html`, контекст `book`, текст с названием, автором и деталями книги         |

---

## 3 Почему в этом случае обязательно нужен объект Клиент `client`?

* Позволяет имитировать **реальные HTTP-запросы** к Django-приложению
* Работает как браузер, но в тестах: можно получить статус, контекст, HTML
* Обязателен, если нужно проверить **рендеринг шаблонов** и работу view с формами

Пример:

```python
url = reverse('book_create')
response = client.get(url)
assert response.status_code == 200
assert 'book_form' in response.context
```

Здесь `client` делает GET-запрос к `book_create`, возвращает ответ, а мы проверяем контекст и статус.


