–í Django, –ø–æ–º–∏–º–æ —É–∂–µ –≥–æ—Ç–æ–≤—ã—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤, –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞–≤–∞—Ç—å —Å–≤–æ–∏ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ.

–ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π:
- 1 –í –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–∏ —Å–æ–∑–¥–∞—ë–º –ø–∞–ø–∫—É –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–æ–≤ `templatetags`
- 2 –í —ç—Ç–æ–π –ø–∞–ø–∫–µ —Å–æ–∑–¥–∞—ë–º py-—Ñ–∞–π–ª (–Ω–∞–ø—Ä–∏–º–µ—Ä, `custom_filters.py`)
- 3 –î–∞–ª–µ–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∏–ª—å—Ç—Ä—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ —à–∞–±–ª–æ–Ω: `{% load custom_filters %}`

# –§–∏–ª—å—Ç—Ä –±–µ–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

–î–ª—è –ø—Ä–∏–º–µ—Ä–∞ —Å–æ–∑–¥–∞–¥–∏–º —Ñ–∏–ª—å—Ç—Ä `currency_format`, –∫–æ—Ç–æ—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —á–∏—Å–ª–∞, –¥–æ–±–∞–≤–ª—è—è
 - —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª–∏ —Ç—ã—Å—è—á (–ø—Ä–æ–±–µ–ª)
 - –¥–ª—è –¥–µ—Å—è—Ç–∏—á–Ω—ã—Ö –∑–Ω–∞–∫–∞ –≤ –∫–æ–Ω—Ü–µ
---

## üîß 1. –°–æ–∑–¥–∞—ë–º —Ñ–∞–π–ª –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ñ–∏–ª—å—Ç—Ä–æ–≤

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
shop/
‚îú‚îÄ‚îÄ templatetags/
‚îÇ   ‚îî‚îÄ‚îÄ custom_filters.py
```


---

## üß™ 2. –°–æ–∑–¥–∞—ë–º –∏ —Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º —Ñ–∏–ª—å—Ç—Ä `currency_format`

**`custom_filters.py`:**

```python
from django import template

register = template.Library()


@register.filter(name='currency_format')
def currency_format(value):
    """
    –ü—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —á–∏—Å–ª–æ –≤ —Ñ–æ—Ä–º–∞—Ç "# ###,00".
    """
    try:
        value = float(value)
    except (TypeError, ValueError):
        # –ï—Å–ª–∏ value –Ω–µ —á–∏—Å–ª–æ - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
        return ''

    # –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º: —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å —Ç—ã—Å—è—á ‚Äî –ø—Ä–æ–±–µ–ª, —Ä–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å –¥—Ä–æ–±–∏ ‚Äî –∑–∞–ø—è—Ç–∞—è
    # f-string —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–º ,.2f —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç 123456.789 –∫–∞–∫ 123,456.79
    # –¥–∞–ª–µ–µ –º–µ–Ω—è–µ–º
    # ',' -> 'X'
    # '.' -> ','
    # 'X' -> ' '
    # 123,456.79 -> 123 456,79
    formatted = f"{value:,.2f}".replace(",", "X").replace(".", ",").replace("X", " ")
    return formatted
```

---

## üìå 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞ –≤ —à–∞–±–ª–æ–Ω–µ

–í —à–∞–±–ª–æ–Ω–µ —Å–Ω–∞—á–∞–ª–∞ –∑–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∏–ª—å—Ç—Ä—ã:

```django
{% load custom_filters %}

{% with price=987564123.9867 %}
  {{ price|currency_format }}  
{% endwith %}
```

# –§–∏–ª—å—Ç—Ä —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏

–ú—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–¥–∞—Ç—å –∏–∑ —à–∞–±–ª–æ–Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –¥–≤–æ–µ—Ç–æ—á–∏–µ.  

–ù–∞–ø—Ä–∏–º–µ—Ä, —É–∫–∞–∑–∞—Ç—å —Ç–∏–ø –≤–∞–ª—é—Ç—ã: (`usd`, `euro` –∏–ª–∏ `rub`):

```django
{% load custom_filters %}

{% with price=987564123.9867 %}
  {{ price|currency_format:usd }}  
{% endwith %}
```

–ò–∑–º–µ–Ω—è–µ–º —Ñ—É–Ω–∫—Ü–∏—é.

–¢–µ–ø–µ—Ä—å, –µ—Å–ª–∏ –≤–∞–ª—é—Ç–∞ –Ω–∞ —É–∫–∞–∑–∞–Ω–∞, –≤—ã–≤–æ–¥–∏–º –∑–Ω–∞–∫ —Ä—É–±–ª–µ–π –≤ –∫–æ–Ω—Ü–µ.
–ê –µ—Å–ª–∏ —É–∫–∞–∑–∞–Ω–∞ - –∑–Ω–∞–∫ –≤–∞–ª—é—Ç—ã –≤ –Ω–∞—á–∞–ª–µ.

–ò–∑–º–µ–Ω—ë–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç —Ñ–∏–ª—å—Ç—Ä–∞:
```python
from django import template

register = template.Library()

CURRENCY_SYMBOLS = {
    'usd': '$',
    'euro': '‚Ç¨',
    'rub': '‚ÇΩ',
}

@register.filter(name='currency_format')
def currency_format(value, currency=None):
    """
    –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ—Ç —á–∏—Å–ª–æ –≤ –¥–µ–Ω–µ–∂–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –≤–∞–ª—é—Ç—ã.
    –ü—Ä–∏–º–µ—Ä:
        {{ 123456.78|currency_format:"usd" }} ‚Üí $123 456,78
        {{ 123456.78|currency_format }} ‚Üí 123 456,78 ‚ÇΩ
    """
    try:
        value = float(value)
    except (TypeError, ValueError):
        return ''

    formatted = f"{value:,.2f}".replace(",", "X").replace(".", ",").replace("X", " ")

    currency = (currency or '').lower()
    symbol = CURRENCY_SYMBOLS.get(currency)

    if symbol:
        return f"{symbol}{formatted}"  # –í–∞–ª—é—Ç–∞ —É–∫–∞–∑–∞–Ω–∞ ‚Äî —Å–∏–º–≤–æ–ª –≤ –Ω–∞—á–∞–ª–µ
    else:
        return f"{formatted} ‚ÇΩ"  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ‚Äî —Ä—É–±–ª—å –≤ –∫–æ–Ω—Ü–µ
```

