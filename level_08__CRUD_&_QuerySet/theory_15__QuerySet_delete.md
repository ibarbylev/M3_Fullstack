# –ú–µ—Ç–æ–¥—ã —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö


---

### üóëÔ∏è –¢–∞–±–ª–∏—Ü–∞: –ú–µ—Ç–æ–¥—ã —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ Django

| –ú–µ—Ç–æ–¥                            | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç                                      | –ü—Ä–∏–º–µ—Ä                                                                  | –í—ã–∑—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã  |
| -------------------------------- | ----------------------------------------------- | ----------------------------------------------------------------------- |-------------------|
| `obj.delete()`                   | –£–¥–∞–ª—è–µ—Ç **–æ–¥–∏–Ω –æ–±—ä–µ–∫—Ç**                         | `obj = Book.objects.get(id=1); obj.delete()`                            | ‚úÖ –î–∞              |
| `QuerySet.delete()`              | –£–¥–∞–ª—è–µ—Ç **–≤—Å–µ –∑–∞–ø–∏—Å–∏ –ø–æ —Ñ–∏–ª—å—Ç—Ä—É**               | `Book.objects.filter(year__lt=1900).delete()`                           | ‚õî –ß–∞—Å—Ç–∏—á–Ω–æ¬π       |
| `Model.objects.all().delete()`   | –£–¥–∞–ª—è–µ—Ç **–≤—Å–µ –∑–∞–ø–∏—Å–∏ –º–æ–¥–µ–ª–∏**                   | `Book.objects.all().delete()`                                           | ‚õî –ß–∞—Å—Ç–∏—á–Ω–æ¬π       | 
| `bulk_delete()` (Django 5.0+)    | –ë—ã—Å—Ç—Ä–æ —É–¥–∞–ª—è–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤               | `Book.objects.filter(active=False).bulk_delete()`                       | ‚ùå –ù–µ—Ç             |
| –£–¥–∞–ª–µ–Ω–∏–µ –∫–∞—Å–∫–∞–¥–æ–º (`CASCADE`)    | –£–¥–∞–ª—è–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–æ–¥–∏—Ç–µ–ª—è | `Author.objects.get(id=1).delete()` (—É–¥–∞–ª–∏—Ç –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–µ `Book`)         | ‚úÖ –î–∞ (—Ä–µ–∫—É—Ä—Å–∏–≤–Ω–æ) |
| `TRUNCATE TABLE`                 | –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É (raw SQL)             | `cursor.execute("TRUNCATE TABLE myapp_book RESTART IDENTITY CASCADE;")` | ‚ùå –ù–µ—Ç             |
| –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É           | –£–¥–∞–ª—è–µ—Ç –≤—ã–±—Ä–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏ —á–µ—Ä–µ–∑ Django Admin     | –í—ã–¥–µ–ª–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –∞–¥–º–∏–Ω–∫–µ –∏ –Ω–∞–∂–∞—Ç–∏–µ "–£–¥–∞–ª–∏—Ç—å"                        | ‚úÖ –î–∞              |
| "–ú—è–≥–∫–æ–µ" —É–¥–∞–ª–µ–Ω–∏–µ (`is_deleted`) | –ü–æ–º–µ—á–∞–µ—Ç –æ–±—ä–µ–∫—Ç –∫–∞–∫ —É–¥–∞–ª—ë–Ω–Ω—ã–π, –Ω–µ —É–¥–∞–ª—è—è –∏–∑ –ë–î  | `obj.is_deleted = True; obj.save()` –∏–ª–∏ `obj.safe_delete()`             | ‚úÖ –î–∞ (`save()`)   |

---

### üßæ –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

**¬π –ß–∞—Å—Ç–∏—á–Ω–æ** ‚Äî `QuerySet.delete()` –∏ `.all().delete()` –Ω–µ –≤—ã–∑—ã–≤–∞—é—Ç `Model.delete()`,   
–ø–æ—ç—Ç–æ–º—É **—Å–∏–≥–Ω–∞–ª—ã `pre_delete` –∏ `post_delete` –Ω–µ —Å—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞**,  
–∞ —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑ ‚Äî –Ω–∞ —É—Ä–æ–≤–Ω–µ QuerySet.

---


## 1. `delete()`: –£–¥–∞–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞

```python
obj = MyModel.objects.get(id=1)
obj.delete()
```

* –£–¥–∞–ª—è–µ—Ç **–æ–¥–Ω—É –∑–∞–ø–∏—Å—å**.
* –í—ã–∑—ã–≤–∞–µ—Ç `delete()` –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (–µ—Å–ª–∏ –µ—Å—Ç—å `on_delete=CASCADE`).

---

## 2. `QuerySet.delete()`: –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤

```python
MyModel.objects.filter(status='inactive').delete()
```

* –£–¥–∞–ª—è–µ—Ç **–≤—Å–µ –æ–±—ä–µ–∫—Ç—ã**, –ø–æ–¥—Ö–æ–¥—è—â–∏–µ –ø–æ–¥ —Ñ–∏–ª—å—Ç—Ä.
* –†–∞–±–æ—Ç–∞–µ—Ç **–Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**, –º–∏–Ω—É—è –≤—ã–∑–æ–≤ `Model.delete()` —É –∫–∞–∂–¥–æ–≥–æ –æ–±—ä–µ–∫—Ç–∞ (—á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å —Å–∏–≥–Ω–∞–ª—ã).

---

## 3. `Model.objects.all().delete()`: –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –º–æ–¥–µ–ª–∏

```python
MyModel.objects.all().delete()
```

* –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—á–∏—â–∞–µ—Ç —Ç–∞–±–ª–∏—Ü—É.
* –û–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ —Ç–µ—Å—Ç–∞—Ö –∏–ª–∏ –¥–ª—è —Å–±—Ä–æ—Å–∞ –¥–∞–Ω–Ω—ã—Ö.

---

## 4. –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `bulk_delete()` (—Å Django 5.0)

```python
MyModel.objects.filter(active=False).bulk_delete()
```

* **–ë—ã—Å—Ç—Ä–µ–µ**, —á–µ–º `QuerySet.delete()`, –Ω–æ **–Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–∏–≥–Ω–∞–ª—ã** (`pre_delete`, `post_delete`).
* –î–æ—Å—Ç—É–ø–Ω–æ —Ç–æ–ª—å–∫–æ —Å Django 5.0+.

---

## 5. –£–¥–∞–ª–µ–Ω–∏–µ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ (ForeignKey / CASCADE)

–ï—Å–ª–∏ —É –≤–∞—Å –µ—Å—Ç—å –º–æ–¥–µ–ª—å —Å –≤–Ω–µ—à–Ω–∏–º –∫–ª—é—á–æ–º:

```python
class Author(models.Model):
    name = models.CharField(...)

class Book(models.Model):
    author = models.ForeignKey(Author, on_delete=models.CASCADE)
```

–£–¥–∞–ª—è—è –∞–≤—Ç–æ—Ä–∞:

```python
Author.objects.get(id=1).delete()
```

‚Äî —É–¥–∞–ª—è—é—Ç—Å—è –∏ –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –∫–Ω–∏–≥–∏ (`Book`) ‚Äî –µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `on_delete=models.CASCADE`.

---

## 6. –û—á–∏—Å—Ç–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è (–æ–±–Ω—É–ª–µ–Ω–∏–µ)

–ò–Ω–æ–≥–¥–∞ –Ω—É–∂–Ω–æ **"—É–¥–∞–ª–∏—Ç—å" –¥–∞–Ω–Ω—ã–µ**, –Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å —Å–∞–º—É —Ç–∞–±–ª–∏—Ü—É:

```python
MyModel.objects.all().delete()
# –∏–ª–∏ —á–µ—Ä–µ–∑ raw SQL:
from django.db import connection
with connection.cursor() as cursor:
    cursor.execute("TRUNCATE TABLE myapp_mymodel RESTART IDENTITY CASCADE;")
```
- `RESTART IDENTITY` - –°–±—Ä–∞—Å—ã–≤–∞–µ—Ç —Å—á—ë—Ç—á–∏–∫–∏ –∞–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞ (`id`, `serial`, `BIGSERIAL` –∏ —Ç.–ø.) –¥–æ 1
- `CASCADE` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—á–∏—â–∞–µ—Ç —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–æ `FK` —Ç–∞–±–ª–∏—Ü—ã
---

## 7. –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω–∫—É

* –ú–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –∑–∞–ø–∏—Å–∏ –≤ Django Admin –∏ —É–¥–∞–ª–∏—Ç—å —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å.
* –í—ã–∑—ã–≤–∞–µ—Ç `ModelAdmin.delete_model()` –∏ `Model.delete()`.

---

## 8. –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ ("–º—è–≥–∫–æ–µ") —É–¥–∞–ª–µ–Ω–∏–µ

* –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å `delete()`–∏ –¥–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `is_deleted`
* –¢–æ–≥–¥–∞ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —ç—Ç–æ –ø–æ–ª–µ –±—É–¥–µ—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è `True`
* –ù–æ —ç—Ç–æ –ø–æ—Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–µ –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –º–æ–¥–µ–ª–∏, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –∏–∑ —Ñ–∏–ª—å—Ç—Ä–∞ –ø–æ–ª—è,  –≥–¥–µ `is_deleted=True` 

### –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –º–µ–Ω–µ–¥–∂–µ—Ä–∞ –¥–ª—è "–º—è–≥–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è"

#### 1. –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤–æ–µ –ø–æ–ª–µ
```python
from django.db import models

class Book(models.Model):
    ...
    is_deleted = models.BooleanField(default=False)

```

#### 2. –°–æ–∑–¥–∞—ë–º —Å–≤–æ–π –º–µ–Ω–µ–¥–∂–µ—Ä:

```python
from django.db import models

class BookManager(models.Manager):
    def get_queryset(self):
        # –ò—Å–∫–ª—é—á–∞–µ–º –ø–æ–º–µ—á–µ–Ω–Ω—ã–µ –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
        return super().get_queryset().filter(is_deleted=False)
```


#### 3. –†–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –≤ –º–æ–¥–µ–ª–∏

```python

class Book(models.Model):
    ...
    is_deleted = models.BooleanField(default=False)
    
    # –£–∫–∞–∑—ã–≤–∞–µ–º –Ω–∞—à –º–µ–Ω–µ–¥–∂–µ—Ä –≤–º–µ—Å—Ç–æ default objects
    objects = BookManager()

```

---

## üö® –í–∞–∂–Ω–æ

* `delete()` **–Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç** –º–µ—Ç–æ–¥ `save()` –∏ **–Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç** –≤—Ä–µ–º—è (`auto_now`).
* –ü–µ—Ä–µ–¥ —É–¥–∞–ª–µ–Ω–∏–µ–º –Ω–µ –∑–∞–±—ã–≤–∞–π—Ç–µ —Å–¥–µ–ª–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ!!!

