# –ê–≥—Ä–µ–≥–∞—Ü–∏—è –∏ –∞–Ω–Ω–æ—Ç–∞—Ü–∏—è

---

| **–ú–µ—Ç–æ–¥**     | **–û–ø–∏—Å–∞–Ω–∏–µ**                                    | **–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç** | **–ü—Ä–∏–º–µ—Ä**                                                  |
| ------------- | ----------------------------------------------- | -------------- | ----------------------------------------------------------- |
| `aggregate()` | –í—ã—á–∏—Å–ª—è–µ—Ç –æ–±—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ (—Å—É–º–º–∞, —Å—Ä–µ–¥–Ω–µ–µ, –º–∞–∫—Å) | `dict`         | `Book.objects.aggregate(Avg('year_published'))`             |
| `annotate()`  | –î–æ–±–∞–≤–ª—è–µ—Ç –≤—ã—á–∏—Å–ª—è–µ–º–æ–µ –ø–æ–ª–µ –∫ –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É    | `QuerySet`     | `Book.objects.values('author').annotate(count=Count('id'))` |
| `count()`     | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ –≤—ã–±–æ—Ä–∫–µ                   | `int`          | `Book.objects.filter(author='–ü—É—à–∫–∏–Ω').count()`              |

---

### üîπ `aggregate()`

–í—ã–ø–æ–ª–Ω—è–µ—Ç **–∞–≥—Ä–µ–≥–∞—Ü–∏—é –ø–æ –≤—Å–µ–π –≤—ã–±–æ—Ä–∫–µ**.  
–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ª–æ–≤–∞—Ä—å —Å –æ–¥–Ω–∏–º –∏–ª–∏ –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∞–≥—Ä–µ–≥–∞—Ç–∞–º–∏.

–ù–∞–ø—Ä–∏–º–µ—Ä, —Å—Ä–µ–¥–Ω–∏–π –≥–æ–¥ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –≤—Å–µ—Ö –∫–Ω–∏–≥:

```python
from django.db.models import Avg

result = Book.objects.aggregate(Avg('year_published'))
print(result['year_published__avg'])  # –Ω–∞–ø—Ä–∏–º–µ—Ä: 1987.4
```

---

### üîπ `annotate()`

–î–æ–±–∞–≤–ª—è–µ—Ç **–≤—ã—á–∏—Å–ª—è–µ–º–æ–µ –ø–æ–ª–µ** –∫ –∫–∞–∂–¥–æ–º—É –æ–±—ä–µ–∫—Ç—É –∏–ª–∏ –≥—Ä—É–ø–ø–µ.  
–ù–∞–ø—Ä–∏–º–µ—Ä, —á–∏—Å–ª–æ –∫–Ω–∏–≥ —É –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞:

```python
from django.db.models import Count

author_counts = Book.objects.values('author').annotate(count=Count('id'))
for item in author_counts:
    print(item['author'], item['count'])
```

–¢–æ –µ—Å—Ç—å —Å–Ω–∞—á–∞–ª–∞ –ø–æ–ª—É—á–∞–µ—Ç—Å—è QuerySet –∞–≤—Ç–æ—Ä–æ–≤ (–∫–æ—Ç–æ—Ä—ã–π –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ —Å–ª–æ–≤–∞—Ä—å),  
–∞ –∑–∞—Ç–µ–º –ø–æ–¥—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –∫–æ–ª-–≤–æ –∑–∞–ø–∏—Å–µ–π –∫–∞–∂–¥–æ–≥–æ –∞–≤—Ç–æ—Ä–∞.

–¢–æ –µ—Å—Ç—å, —ç—Ç–æ—Ç –∑–∞–ø—Ä–æ—Å –∞–Ω–∞–ª–æ–≥–∏—á–µ–Ω –∑–∞–ø—Ä–æ—Å—É
```sql
SELECT 
    author_id, COUNT(id) AS count
FROM 
    myapp_book
GROUP BY 
    author_id;

```

---

### üîπ `count()`

–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—ä–µ–∫—Ç–æ–≤ –≤ QuerySet.  
–≠—Ç–æ —Å–æ–∫—Ä–∞—â—ë–Ω–Ω–∞—è —Ñ–æ—Ä–º–∞ –∞–≥—Ä–µ–≥–∞—Ç–∞ `Count(*)`.

–ù–∞–ø—Ä–∏–º–µ—Ä, —Å–∫–æ–ª—å–∫–æ –∫–Ω–∏–≥ –Ω–∞–ø–∏—Å–∞–ª –ü—É—à–∫–∏–Ω:

```python
book_count = Book.objects.filter(author='–ü—É—à–∫–∏–Ω').count()
print(book_count)
```

